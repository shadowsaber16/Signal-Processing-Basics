fs=8192;
xn=rand(1,2*fs)-0.5;
f0=1024;
t=1:1:100;
y_add=zeros(size(xn));
for i=1:length(xn)
    y_add(i)=xn(i)+sin(2*pi*f0*(i-1)*fs);
end
N=2001;
w0=pi/4;
b0=1/((1-exp(1i*w0))*(1-exp(-1i*w0)));
b1=[1,-exp(1i*w0)];
b2=[1,-exp(-1i*w0)];
b=b0*conv(b1,b2);
a0=1;
a1=[1,0];
a2=[1,0];
a=a0*conv(a1,a2);
y=filter(b,a,y_add);
%sound(y,fs);
subplot(2,2,1);
plot(t,y_add(1:100));
subplot(2,2,2);
plot(t,y(1:100));

r0=0.99;
b0=(1-r0*exp(1i*w0))*(1-r0*exp(-1i*w0))/((1-exp(1i*w0))*(1-exp(-1i*w0)));
b1=[1,-exp(1i*w0)];
b2=[1,-exp(-1i*w0)];
b=b0*conv(b1,b2);
a1=[1,-r0*exp(1i*w0)];
a2=[1,-r0*exp(-1i*w0)];
a=conv(a1,a2);
y=filter(b,a,y_add);
subplot(2,2,3);
plot(t,y_add(1:100));
subplot(2,2,4);
plot(t,y(1:100));
sound(y,fs);